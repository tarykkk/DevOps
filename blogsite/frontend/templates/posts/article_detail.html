{% extends "base.html" %}

{% block page_title %}{{ article.title }}{% endblock %}

{% block meta_description %}{{ article.excerpt|default:article.content|truncatewords:20 }}{% endblock %}

{% block main_content %}
<article>
    <h1>{{ article.title }}</h1>
    
    <div class="meta-info">
        üìÖ –û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–æ <strong>{{ article.published_at|date:"d F Y –æ H:i" }}</strong><br>
        ‚úçÔ∏è –ê–≤—Ç–æ—Ä: <strong>{{ article.author.get_full_name|default:article.author.username }}</strong>
    </div>
    
    <div class="article-content">
        {{ article.content|linebreaks }}
    </div>
    
    <div class="action-bar">
        <a href="{% url 'posts:share_article' article.id %}" class="action-btn">
            üìß –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è —Å—Ç–∞—Ç—Ç–µ—é
        </a>
        <a href="{% url 'posts:article_list' %}" class="action-btn">
            ‚Üê –í—Å—ñ —Å—Ç–∞—Ç—Ç—ñ
        </a>
    </div>
</article>

<section class="feedback-section">
    <div class="feedback-header">
        <h2>üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ ({{ feedbacks.count }})</h2>
    </div>

    {% if feedbacks %}
        {% for feedback in feedbacks %}
            <div class="feedback-item">
                <div class="feedback-meta">
                    <strong>{{ feedback.author_name }}</strong> ‚Ä¢ 
                    {{ feedback.created_at|date:"d F Y, H:i" }}
                </div>
                <div class="feedback-content">
                    {{ feedback.content|linebreaks }}
                </div>
            </div>
        {% endfor %}
    {% else %}
        <p class="no-feedback">
            –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –ø–æ–∫–∏ —â–æ –Ω–µ–º–∞—î. –ë—É–¥—å—Ç–µ –ø–µ—Ä—à–∏–º, —Ö—Ç–æ –∑–∞–ª–∏—à–∏—Ç—å –≤—ñ–¥–≥—É–∫!
        </p>
    {% endif %}

    <div class="form-wrapper">
        <h3>–ó–∞–ª–∏—à–∏—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä</h3>
        <form action="{% url 'posts:submit_feedback' article.id %}" method="post">
            {% csrf_token %}
            
            <div class="form-group">
                {{ feedback_form.author_name.label_tag }}
                {{ feedback_form.author_name }}
            </div>
            
            <div class="form-group">
                {{ feedback_form.author_email.label_tag }}
                {{ feedback_form.author_email }}
            </div>
            
            <div class="form-group">
                {{ feedback_form.content.label_tag }}
                {{ feedback_form.content }}
            </div>
            
            <button type="submit" class="submit-btn">
                –û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä
            </button>
        </form>
    </div>
</section>
{% endblock %}